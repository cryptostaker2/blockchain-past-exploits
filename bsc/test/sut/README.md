 ## SUT Token Exploit, 21 July 2023 - Fixed Token Sale Exploit

 ### Summary 

 - SUT token can be bought at a fixed price
 - There's a liquidity pool with SUT and WBNB
 - At one point, the price of SUT in the liquidity pool is higher than the fixed price
 - Attacker flashloaned 10 BNB from DPPOracle (Dodo Private Pool) and arbitrage the difference in price
- Total loss: **32 BNB (~7k USD)**

### Test command

 > forge test --contracts ./bsc/test/sut/sut.t.sol
 
 ### Proof of Concept

 [sut.t.sol](https://github.com/cryptostaker2/blockchain-past-exploits/blob/main/bsc/test/sut/sut.t.sol)

 ### Transaction References
 1. [Attack Transaction](https://bscscan.com/tx/0xfa1ece5381b9e2b2b83cb10faefde7632ca411bb38dd6bafe1f1140b1360f6ae)
 2. [Vulnerable Contract](https://bscscan.com/address/0xf075c5c7ba59208c0b9c41afccd1f60da9ec9c37)
 3. [Attacker](https://bscscan.com/address/0x547fb3db0f13eed5d3ff930a0b61ae35b173b4b5)
 4. [Attack Contract](https://bscscan.com/address/0x9be508ce41ae5795e1ebc247101c40da7d5742db)
 5. [Phalcon Explorer](https://explorer.phalcon.xyz/tx/bsc/0xfa1ece5381b9e2b2b83cb10faefde7632ca411bb38dd6bafe1f1140b1360f6ae)

### In-depth Explanation