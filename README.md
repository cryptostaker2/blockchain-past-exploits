## Blockchain Past Exploits
All blockchain past exploits, with PoCs and in-depth explanation

## Summary

[27072023 SUT Token Exploit](https://github.com/cryptostaker2/blockchain-past-exploits/tree/main/bsc/test/sut)
<br>
[07072023 LUSD Protocol Exploit](https://github.com/cryptostaker2/blockchain-past-exploits/tree/main/bsc/test/lusd)


## Binance Smart Chain (BSC) Past Exploits

### [SUT Token Exploit](https://github.com/cryptostaker2/blockchain-past-exploits/tree/main/bsc/test/sut), 21 July 2023 - Fixed Token Sale Exploit

 #### Summary

 - SUT token can be bought at a fixed price 
 - There's a liquidity pool with SUT and WBNB
 - At one point, the price of SUT in the liquidity pool is higher than the fixed price
 - Attacker flashloaned 10 BNB from DPPOracle (Dodo Private Pool) and arbitrage the difference in price
 - Total loss: **32 BNB (~7k USD)**

### Proof of Concept 

[sut.t.sol](https://github.com/cryptostaker2/blockchain-past-exploits/blob/main/bsc/test/sut/sut.t.sol)

### More Details

[SUT Exploit](https://github.com/cryptostaker2/blockchain-past-exploits/tree/main/bsc/test/sut)

## LUSD Protocol Exploit, 07 July 2023 - Internal Oracle Price Manipulation

### Summary 

- Attacker gets a ~3.5m BUSD flashloan from 5 different DODO oracles
- Attacker calls a flashswap on the BUSD-BTCB pair and withdraws 1.2 BTC
- Attacker transfers 800,000 BUSD to the pair through the `pancakeCall()` callback function
- Originally, one BTC was worth ~30k. After the transfer, 1 BTC is worth ~11m
- Attacker calls `supply()` on the Loan contract and mints 10,000 LUSD with 0.0015 BTC. This works because the `supply()` function checks the price of BTCB in terms of BUSD. Since the price was manipulated in the first swap, 1 BTC is worth a lot now
- Attacker calls `withdraw()` on the LUSDPool contract. 1 LUSD is pegged to 1 BUSD, so the attacker manages to withdraw 10,000 BUSD. The reason why the attacker only can withdraw 10,000 BUSD is because the LUSDPool contract only have 10,000 BUSD inside at the moment of the attack
- Attacker transfers 1.2 BTC back to the BUSD-BTCB pair
- Attacker calls a flashswap again, this time without a callback on the BUSD-BTCB pair and withdraws 799,794 BUSD
- Attacker repays the 3.5m flashloan and profitted ~9.5k BUSD.
- Total loss: **~9.5k BUSD**

 ### Proof of Concept

 [lusd.t.sol](https://github.com/cryptostaker2/blockchain-past-exploits/blob/main/bsc/test/lusd/lusd.t.sol)

### More Details

[LUSD Exploit](https://github.com/cryptostaker2/blockchain-past-exploits/tree/main/bsc/test/lusd)